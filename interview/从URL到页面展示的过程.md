### 以网络通信的角度看URL到页面展示的过程

当我们从地址拦输入网址[www.baidu.com](www.baidu.com)或者在网页点击某个链接后,浏览器最终把页面展现需要经历哪些过程呢？
主要分为两部分：网络通信和页面渲染

#### 1. 网络通信

互联网设备之间的通信都遵循TCP/IP协议，TCP/IP协议族通信时，会按照分层顺序进行；上到下可分为应用层、传输层、网络层、数据链路层。

![TCP/IP分层](https://github.com/ytuan996/notebook/blob/master/network/image/TCPIP.png?raw=true)

1.在浏览器地址栏输入url：http://www.baidu.com ，其中http为协议，www.baidu.com是地址，指明了资源所在主机，baidu 是域名，
也可以是IP地址，但我们为了方便记忆，通常使用域名，然后通过DNS服务将域名解析为IP地址。

2.应用层DNS域名解析；首先检查本机是否有域名对应的IP地址，没有则请求本地域名服务器解析IP。

3.应用层client发送HTTP请求；HTTP请求主要包括两部分，请求头和请求主体，请求头包含使用的协议，请求方式，目标url，是否有缓存，
是否带cookie等详细信息。

4.传输层TCP发送报文；传输层使用面向连接的TCP可靠字节流服务，在传输数据之前需要建立连接，TCP连接三次握手；

5.网络层IP协议查询MAC地址，网络中的设备IP地址和MAC地址是一一对应的，IP地址可变，但是MAC地址固定不变；使用ARP协议将IP地址转换
为MAC地址

6.数据链路层传输数据；在找到MAC地址后，就可以将数据发送到数据链路层进行传输，此时client的请求结束。

7.服务器接收数据；服务器从数据链路层接收到数据，然后层层解析直到应用层，然后重新组装为HTTP请求报文

8.服务器处理请求；服务器根据client的请求报文，查找请求资源，返回响应报文；

9.服务器返回文件；服务器返回相应的HTML文件。

#### 2. 页面渲染

现代浏览器渲染页面的过程是这样的：解析HTML以构建DOM树 –> 构建渲染树 –> 布局渲染树 –> 绘制渲染树。

在浏览器还没接收到完整的HTML文件时，它就开始渲染页面了，在遇到外部链入的脚本标签或样式标签或图片时，会再次发送HTTP请求重复上
述的步骤。在收到CSS文件后会对已经渲染的页面重新渲染，加入它们应有的样式，图片文件加载完立刻显示在相应位置。在这一过程中可能
会触发页面的重绘或重排。